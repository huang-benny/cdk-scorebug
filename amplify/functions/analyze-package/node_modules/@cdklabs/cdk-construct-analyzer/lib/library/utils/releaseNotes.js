"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.analyzeReleaseNotesContent = analyzeReleaseNotesContent;
exports.countFeatsAndFixes = countFeatsAndFixes;
/**
 * Analyzes GitHub releases to determine if they include features and fixes
 */
function analyzeReleaseNotesContent(repository) {
    if (!repository.releases || repository.releases.length === 0) {
        return { hasFeats: false, hasFixes: false };
    }
    // Filter releases from the past year
    const oneYearAgo = new Date();
    oneYearAgo.setFullYear(oneYearAgo.getFullYear() - 1);
    const releasesFromPastYear = repository.releases.filter(release => {
        if (!release.publishedAt)
            return false;
        const publishedDate = new Date(release.publishedAt);
        return publishedDate >= oneYearAgo;
    });
    let hasFeats = false;
    let hasFixes = false;
    for (const release of releasesFromPastYear) {
        if (release.description) {
            if (!hasFeats && hasFeatureContent(release.description)) {
                hasFeats = true;
            }
            if (!hasFixes && hasFixContent(release.description)) {
                hasFixes = true;
            }
            // Early exit if we found both
            if (hasFeats && hasFixes) {
                break;
            }
        }
    }
    return { hasFeats, hasFixes };
}
/**
 * Count the number of features and bug fixes from release notes in the past year
 */
function countFeatsAndFixes(repository) {
    if (!repository.releases || repository.releases.length === 0) {
        return 0;
    }
    const oneYearAgo = new Date();
    oneYearAgo.setFullYear(oneYearAgo.getFullYear() - 1);
    const releasesInPastYear = repository.releases.filter(release => {
        if (!release.publishedAt) {
            return false;
        }
        const publishedDate = new Date(release.publishedAt);
        return publishedDate >= oneYearAgo;
    });
    let count = 0;
    for (const release of releasesInPastYear) {
        if (release.description) {
            count += countFeatsAndFixesInDescription(release.description);
        }
    }
    return count;
}
/**
 * Count features and fixes in a release description
 * Looks for "feat" or "fix" keywords
 */
function countFeatsAndFixesInDescription(description) {
    const lowerDescription = description.toLowerCase();
    const featCount = (lowerDescription.match(/feat/g) ?? []).length;
    const fixCount = (lowerDescription.match(/fix/g) ?? []).length;
    return featCount + fixCount;
}
/**
 * Checks if release description contains feature-related content
 */
function hasFeatureContent(description) {
    return description.toLowerCase().includes('feat');
}
/**
 * Checks if release description contains fix-related content
 */
function hasFixContent(description) {
    return description.toLowerCase().includes('fix');
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVsZWFzZU5vdGVzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2xpYnJhcnkvdXRpbHMvcmVsZWFzZU5vdGVzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBS0EsZ0VBbUNDO0FBS0QsZ0RBMEJDO0FBckVEOztHQUVHO0FBQ0gsU0FBZ0IsMEJBQTBCLENBQUMsVUFBNEI7SUFDckUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLElBQUksVUFBVSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFLENBQUM7UUFDN0QsT0FBTyxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxDQUFDO0lBQzlDLENBQUM7SUFFRCxxQ0FBcUM7SUFDckMsTUFBTSxVQUFVLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztJQUM5QixVQUFVLENBQUMsV0FBVyxDQUFDLFVBQVUsQ0FBQyxXQUFXLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQztJQUVyRCxNQUFNLG9CQUFvQixHQUFHLFVBQVUsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFO1FBQ2hFLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVztZQUFFLE9BQU8sS0FBSyxDQUFDO1FBQ3ZDLE1BQU0sYUFBYSxHQUFHLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUNwRCxPQUFPLGFBQWEsSUFBSSxVQUFVLENBQUM7SUFDckMsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFJLFFBQVEsR0FBRyxLQUFLLENBQUM7SUFDckIsSUFBSSxRQUFRLEdBQUcsS0FBSyxDQUFDO0lBRXJCLEtBQUssTUFBTSxPQUFPLElBQUksb0JBQW9CLEVBQUUsQ0FBQztRQUMzQyxJQUFJLE9BQU8sQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUN4QixJQUFJLENBQUMsUUFBUSxJQUFJLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDO2dCQUN4RCxRQUFRLEdBQUcsSUFBSSxDQUFDO1lBQ2xCLENBQUM7WUFDRCxJQUFJLENBQUMsUUFBUSxJQUFJLGFBQWEsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQztnQkFDcEQsUUFBUSxHQUFHLElBQUksQ0FBQztZQUNsQixDQUFDO1lBRUQsOEJBQThCO1lBQzlCLElBQUksUUFBUSxJQUFJLFFBQVEsRUFBRSxDQUFDO2dCQUN6QixNQUFNO1lBQ1IsQ0FBQztRQUNILENBQUM7SUFDSCxDQUFDO0lBRUQsT0FBTyxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsQ0FBQztBQUNoQyxDQUFDO0FBRUQ7O0dBRUc7QUFDSCxTQUFnQixrQkFBa0IsQ0FBQyxVQUE0QjtJQUM3RCxJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsSUFBSSxVQUFVLENBQUMsUUFBUSxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUUsQ0FBQztRQUM3RCxPQUFPLENBQUMsQ0FBQztJQUNYLENBQUM7SUFFRCxNQUFNLFVBQVUsR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO0lBQzlCLFVBQVUsQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLFdBQVcsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBRXJELE1BQU0sa0JBQWtCLEdBQUcsVUFBVSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUU7UUFDOUQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUN6QixPQUFPLEtBQUssQ0FBQztRQUNmLENBQUM7UUFFRCxNQUFNLGFBQWEsR0FBRyxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDcEQsT0FBTyxhQUFhLElBQUksVUFBVSxDQUFDO0lBQ3JDLENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBSSxLQUFLLEdBQUcsQ0FBQyxDQUFDO0lBRWQsS0FBSyxNQUFNLE9BQU8sSUFBSSxrQkFBa0IsRUFBRSxDQUFDO1FBQ3pDLElBQUksT0FBTyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ3hCLEtBQUssSUFBSSwrQkFBK0IsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDaEUsQ0FBQztJQUNILENBQUM7SUFFRCxPQUFPLEtBQUssQ0FBQztBQUNmLENBQUM7QUFFRDs7O0dBR0c7QUFDSCxTQUFTLCtCQUErQixDQUFDLFdBQW1CO0lBQzFELE1BQU0sZ0JBQWdCLEdBQUcsV0FBVyxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBRW5ELE1BQU0sU0FBUyxHQUFHLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQztJQUNqRSxNQUFNLFFBQVEsR0FBRyxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUM7SUFFL0QsT0FBTyxTQUFTLEdBQUcsUUFBUSxDQUFDO0FBQzlCLENBQUM7QUFFRDs7R0FFRztBQUNILFNBQVMsaUJBQWlCLENBQUMsV0FBbUI7SUFDNUMsT0FBTyxXQUFXLENBQUMsV0FBVyxFQUFFLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ3BELENBQUM7QUFFRDs7R0FFRztBQUNILFNBQVMsYUFBYSxDQUFDLFdBQW1CO0lBQ3hDLE9BQU8sV0FBVyxDQUFDLFdBQVcsRUFBRSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUNuRCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgR2l0SHViUmVwb3NpdG9yeSwgUmVsZWFzZU5vdGVzRGF0YSB9IGZyb20gJy4uL3R5cGVzJztcblxuLyoqXG4gKiBBbmFseXplcyBHaXRIdWIgcmVsZWFzZXMgdG8gZGV0ZXJtaW5lIGlmIHRoZXkgaW5jbHVkZSBmZWF0dXJlcyBhbmQgZml4ZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFuYWx5emVSZWxlYXNlTm90ZXNDb250ZW50KHJlcG9zaXRvcnk6IEdpdEh1YlJlcG9zaXRvcnkpOiBSZWxlYXNlTm90ZXNEYXRhIHtcbiAgaWYgKCFyZXBvc2l0b3J5LnJlbGVhc2VzIHx8IHJlcG9zaXRvcnkucmVsZWFzZXMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIHsgaGFzRmVhdHM6IGZhbHNlLCBoYXNGaXhlczogZmFsc2UgfTtcbiAgfVxuXG4gIC8vIEZpbHRlciByZWxlYXNlcyBmcm9tIHRoZSBwYXN0IHllYXJcbiAgY29uc3Qgb25lWWVhckFnbyA9IG5ldyBEYXRlKCk7XG4gIG9uZVllYXJBZ28uc2V0RnVsbFllYXIob25lWWVhckFnby5nZXRGdWxsWWVhcigpIC0gMSk7XG5cbiAgY29uc3QgcmVsZWFzZXNGcm9tUGFzdFllYXIgPSByZXBvc2l0b3J5LnJlbGVhc2VzLmZpbHRlcihyZWxlYXNlID0+IHtcbiAgICBpZiAoIXJlbGVhc2UucHVibGlzaGVkQXQpIHJldHVybiBmYWxzZTtcbiAgICBjb25zdCBwdWJsaXNoZWREYXRlID0gbmV3IERhdGUocmVsZWFzZS5wdWJsaXNoZWRBdCk7XG4gICAgcmV0dXJuIHB1Ymxpc2hlZERhdGUgPj0gb25lWWVhckFnbztcbiAgfSk7XG5cbiAgbGV0IGhhc0ZlYXRzID0gZmFsc2U7XG4gIGxldCBoYXNGaXhlcyA9IGZhbHNlO1xuXG4gIGZvciAoY29uc3QgcmVsZWFzZSBvZiByZWxlYXNlc0Zyb21QYXN0WWVhcikge1xuICAgIGlmIChyZWxlYXNlLmRlc2NyaXB0aW9uKSB7XG4gICAgICBpZiAoIWhhc0ZlYXRzICYmIGhhc0ZlYXR1cmVDb250ZW50KHJlbGVhc2UuZGVzY3JpcHRpb24pKSB7XG4gICAgICAgIGhhc0ZlYXRzID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGlmICghaGFzRml4ZXMgJiYgaGFzRml4Q29udGVudChyZWxlYXNlLmRlc2NyaXB0aW9uKSkge1xuICAgICAgICBoYXNGaXhlcyA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIC8vIEVhcmx5IGV4aXQgaWYgd2UgZm91bmQgYm90aFxuICAgICAgaWYgKGhhc0ZlYXRzICYmIGhhc0ZpeGVzKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7IGhhc0ZlYXRzLCBoYXNGaXhlcyB9O1xufVxuXG4vKipcbiAqIENvdW50IHRoZSBudW1iZXIgb2YgZmVhdHVyZXMgYW5kIGJ1ZyBmaXhlcyBmcm9tIHJlbGVhc2Ugbm90ZXMgaW4gdGhlIHBhc3QgeWVhclxuICovXG5leHBvcnQgZnVuY3Rpb24gY291bnRGZWF0c0FuZEZpeGVzKHJlcG9zaXRvcnk6IEdpdEh1YlJlcG9zaXRvcnkpOiBudW1iZXIge1xuICBpZiAoIXJlcG9zaXRvcnkucmVsZWFzZXMgfHwgcmVwb3NpdG9yeS5yZWxlYXNlcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gMDtcbiAgfVxuXG4gIGNvbnN0IG9uZVllYXJBZ28gPSBuZXcgRGF0ZSgpO1xuICBvbmVZZWFyQWdvLnNldEZ1bGxZZWFyKG9uZVllYXJBZ28uZ2V0RnVsbFllYXIoKSAtIDEpO1xuXG4gIGNvbnN0IHJlbGVhc2VzSW5QYXN0WWVhciA9IHJlcG9zaXRvcnkucmVsZWFzZXMuZmlsdGVyKHJlbGVhc2UgPT4ge1xuICAgIGlmICghcmVsZWFzZS5wdWJsaXNoZWRBdCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGNvbnN0IHB1Ymxpc2hlZERhdGUgPSBuZXcgRGF0ZShyZWxlYXNlLnB1Ymxpc2hlZEF0KTtcbiAgICByZXR1cm4gcHVibGlzaGVkRGF0ZSA+PSBvbmVZZWFyQWdvO1xuICB9KTtcblxuICBsZXQgY291bnQgPSAwO1xuXG4gIGZvciAoY29uc3QgcmVsZWFzZSBvZiByZWxlYXNlc0luUGFzdFllYXIpIHtcbiAgICBpZiAocmVsZWFzZS5kZXNjcmlwdGlvbikge1xuICAgICAgY291bnQgKz0gY291bnRGZWF0c0FuZEZpeGVzSW5EZXNjcmlwdGlvbihyZWxlYXNlLmRlc2NyaXB0aW9uKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gY291bnQ7XG59XG5cbi8qKlxuICogQ291bnQgZmVhdHVyZXMgYW5kIGZpeGVzIGluIGEgcmVsZWFzZSBkZXNjcmlwdGlvblxuICogTG9va3MgZm9yIFwiZmVhdFwiIG9yIFwiZml4XCIga2V5d29yZHNcbiAqL1xuZnVuY3Rpb24gY291bnRGZWF0c0FuZEZpeGVzSW5EZXNjcmlwdGlvbihkZXNjcmlwdGlvbjogc3RyaW5nKTogbnVtYmVyIHtcbiAgY29uc3QgbG93ZXJEZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uLnRvTG93ZXJDYXNlKCk7XG5cbiAgY29uc3QgZmVhdENvdW50ID0gKGxvd2VyRGVzY3JpcHRpb24ubWF0Y2goL2ZlYXQvZykgPz8gW10pLmxlbmd0aDtcbiAgY29uc3QgZml4Q291bnQgPSAobG93ZXJEZXNjcmlwdGlvbi5tYXRjaCgvZml4L2cpID8/IFtdKS5sZW5ndGg7XG5cbiAgcmV0dXJuIGZlYXRDb3VudCArIGZpeENvdW50O1xufVxuXG4vKipcbiAqIENoZWNrcyBpZiByZWxlYXNlIGRlc2NyaXB0aW9uIGNvbnRhaW5zIGZlYXR1cmUtcmVsYXRlZCBjb250ZW50XG4gKi9cbmZ1bmN0aW9uIGhhc0ZlYXR1cmVDb250ZW50KGRlc2NyaXB0aW9uOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgcmV0dXJuIGRlc2NyaXB0aW9uLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2ZlYXQnKTtcbn1cblxuLyoqXG4gKiBDaGVja3MgaWYgcmVsZWFzZSBkZXNjcmlwdGlvbiBjb250YWlucyBmaXgtcmVsYXRlZCBjb250ZW50XG4gKi9cbmZ1bmN0aW9uIGhhc0ZpeENvbnRlbnQoZGVzY3JpcHRpb246IHN0cmluZyk6IGJvb2xlYW4ge1xuICByZXR1cm4gZGVzY3JpcHRpb24udG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnZml4Jyk7XG59Il19